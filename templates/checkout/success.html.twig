{% extends 'base_public.html.twig' %}

{% block title %}Commande confirmée - Winter Sports Shop{% endblock %}

{% block body %}
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            {# En-tête de succès #}
            <div class="text-center mb-5">
                <div class="success-icon mb-4">
                    <i class="bi bi-check-circle-fill text-success" style="font-size: 5rem;"></i>
                </div>
                <h1 class="display-4 mb-3">Commande confirmée !</h1>
                <p class="lead text-muted">Merci pour votre achat</p>
                <p class="text-muted">Un email de confirmation vous a été envoyé à <strong>{{ order.user.email }}</strong></p>
            </div>

            {# Détails de la commande #}
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Détails de la commande</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <strong>Numéro de commande :</strong><br>
                            <span class="text-primary fs-5">{{ order.reference }}</span>
                        </div>
                        <div class="col-md-6 mb-3">
                            <strong>Date :</strong><br>
                            {{ order.createdAt|date('d/m/Y à H:i') }}
                        </div>
                        <div class="col-md-6 mb-3">
                            <strong>Statut :</strong><br>
                            <span class="badge bg-warning">{{ order.status.value }}</span>
                        </div>
                        <div class="col-md-6 mb-3">
                            <strong>Montant total :</strong><br>
                            <span class="fs-4 text-success">{{ order.totalAmount }} €</span>
                        </div>
                    </div>
                </div>
            </div>

            {# Articles commandés #}
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">Articles commandés</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Produit</th>
                                    <th class="text-center">Quantité</th>
                                    <th class="text-end">Prix unitaire</th>
                                    <th class="text-end">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in order.items %}
                                    <tr>
                                        <td>
                                            <strong>{{ item.product.name }}</strong>
                                        </td>
                                        <td class="text-center">{{ item.quantity }}</td>
                                        <td class="text-end">{{ item.unitPrice }} €</td>
                                        <td class="text-end"><strong>{{ item.totalPrice }} €</strong></td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                            <tfoot>
                                <tr class="table-active">
                                    <td colspan="3" class="text-end"><strong>Total TTC :</strong></td>
                                    <td class="text-end"><strong class="text-success fs-5">{{ order.totalAmount }} €</strong></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>

            {# Adresses #}
            <div class="row mb-4">
                <div class="col-md-6 mb-3">
                    <div class="card h-100">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">
                                <i class="bi bi-truck"></i> Adresse de livraison
                            </h6>
                        </div>
                        <div class="card-body">
                            <strong>{{ order.shippingAddress.firstName }} {{ order.shippingAddress.lastName }}</strong><br>
                            {{ order.shippingAddress.street }}<br>
                            {% if order.shippingAddress.additionalInfo %}
                                {{ order.shippingAddress.additionalInfo }}<br>
                            {% endif %}
                            {{ order.shippingAddress.postalCode }} {{ order.shippingAddress.city }}<br>
                            {{ order.shippingAddress.country }}
                        </div>
                    </div>
                </div>

                <div class="col-md-6 mb-3">
                    <div class="card h-100">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">
                                <i class="bi bi-receipt"></i> Adresse de facturation
                            </h6>
                        </div>
                        <div class="card-body">
                            <strong>{{ order.billingAddress.firstName }} {{ order.billingAddress.lastName }}</strong><br>
                            {{ order.billingAddress.street }}<br>
                            {% if order.billingAddress.additionalInfo %}
                                {{ order.billingAddress.additionalInfo }}<br>
                            {% endif %}
                            {{ order.billingAddress.postalCode }} {{ order.billingAddress.city }}<br>
                            {{ order.billingAddress.country }}
                        </div>
                    </div>
                </div>
            </div>

            {# Informations supplémentaires #}
            <div class="alert alert-info">
                <h6 class="alert-heading">
                    <i class="bi bi-info-circle"></i> Prochaines étapes
                </h6>
                <ul class="mb-0">
                    <li>Votre commande est en cours de traitement</li>
                    <li>Vous recevrez un email dès l'expédition de votre colis</li>
                    <li>Délai de livraison estimé : 3-5 jours ouvrés</li>
                </ul>
            </div>

            {# Actions #}
            <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                <a href="{{ path(constant('App\\Constant\\Route::SHOP').value) }}" class="btn btn-primary btn-lg">
                    <i class="bi bi-shop"></i> Continuer mes achats
                </a>
                <button onclick="window.print()" class="btn btn-outline-secondary btn-lg">
                    <i class="bi bi-printer"></i> Imprimer
                </button>
            </div>
        </div>
    </div>
</div>

<style>
@media print {
    .btn, nav, footer {
        display: none;
    }
}

.success-icon i {
    animation: scaleIn 0.5s ease-out;
}

@keyframes scaleIn {
    from {
        transform: scale(0);
        opacity: 0;
    }
    to {
        transform: scale(1);
        opacity: 1;
    }
}
</style>
{% endblock %}